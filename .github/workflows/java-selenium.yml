name: Java Selenium Examples CI/CD tests

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  schedule:
    - cron: "0 0 * * 1"

jobs:
  test:
    strategy:
      matrix: { folder: ["java-selenium-web"] }
      
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4
    - name: Set up JDK 23
      uses: actions/setup-java@v4
      with:
        java-version: '23'
        distribution: 'HotSpot'
        cache: maven
        
    - name: Build with Maven
      run: mvn -B package --file pom.xml

    - name: Setup Chrome
      uses: browser-actions/setup-chrome@v1.7.3
      with:
        chrome-version: '134'
        install-chromedriver: true

    # Optional: Uploads the full dependency graph to GitHub to improve the quality of Dependabot alerts this repository can receive
    - name: Update dependency graph
      uses: advanced-security/maven-dependency-submission-action@571e99aab1055c2e71a1e2309b9691de18d6b7d6

    - name: Run Evinced tests
      id: run-tests
      env:
        EVINCED_SERVICE_ID: ${{ secrets.EVINCED_SERVICE_ID }}
        EVINCED_API_KEY: ${{ secrets.EVINCED_API_KEY }}
        EVINCED_AUTH_TOKEN: ${{ secrets.EVINCED_AUTH_TOKEN }}
      run: | 
          mvn clean test
